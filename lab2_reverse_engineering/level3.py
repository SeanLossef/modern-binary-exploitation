import interact
import struct

p = interact.Process()
for j in range(200):
    p.readuntil('CHALLENGE: ')
    challenge = p.readuntil('RESPONSE: ')[:-12]
    
    # Part 1
    part1 = 0
    for i in range(5):
        part1 = part1 << 0x7
        part1 = part1 ^ ord(challenge[i])
    
    # Part 2
    part2 = ""
    for i in range(5):
        x = 0
        a = ord(challenge[i + 0x6])
        x = (x ^ a) & 0xff
        a = ord(challenge[i + 0xc])
        x = (x ^ a) & 0xff
        a = ord(challenge[i + 0x12])
        x = (x ^ a) & 0xff
        part2 += '{:x}'.format(x).upper()
    
    # Part 3
    part3 = ""
    magic = [0xf8, 0x38, 0x5b, 0x7d, 0x05, 0x49] # Data at 0x6020b0
    for i in range(5):
        c = magic[i] * ord(challenge[i + 24])
        d = (c * 0x4ec4ec4f) >> 35
        a = c >> 0x1f
        d -= a
        a = d * 0x1a
        c -= a
        d = c & 0xff
        d += 0x41
        part3 += chr(d)
    
    response = str(part1) + "/" + part2 + "/" + part3
    print(challenge + " -> " + response)
    p.sendline(response)
p.interactive()